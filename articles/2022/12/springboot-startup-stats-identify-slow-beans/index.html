<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="SpringBoot StartUp Stats - A tool to identify beans which are slowing down your application startup" /><meta property="og:locale" content="en" /><meta name="description" content="A Spring application is basically made up of Spring beans, “wrappers” of actual Java classes that are created by Spring framework at start-up (or on request if lazy-initialized) and injected as dependency where needed. That said, the start-up procedure of a Spring Boot application can be seen as a Tree, in which the roots are some internal Spring procedures and intermediate and leaf nodes are beans initializations. If bean “A” needs bean “B” as dependency, B will be child of A and the time needed to initialize bean A will be the time needed by A itself plus the summed time of its children." /><meta property="og:description" content="A Spring application is basically made up of Spring beans, “wrappers” of actual Java classes that are created by Spring framework at start-up (or on request if lazy-initialized) and injected as dependency where needed. That said, the start-up procedure of a Spring Boot application can be seen as a Tree, in which the roots are some internal Spring procedures and intermediate and leaf nodes are beans initializations. If bean “A” needs bean “B” as dependency, B will be child of A and the time needed to initialize bean A will be the time needed by A itself plus the summed time of its children." /><link rel="canonical" href="https://pdemartino.github.io/articles/2022/12/springboot-startup-stats-identify-slow-beans/" /><meta property="og:url" content="https://pdemartino.github.io/articles/2022/12/springboot-startup-stats-identify-slow-beans/" /><meta property="og:site_name" content="Pasquale De Martino" /><meta property="og:image" content="https://pdemartino.github.io/assets/img/misc/stopwatch-photo-by-tsvetoslav-hristov-on-unsplash.webp" /><meta property="og:image:alt" content="Stopwatch photo by Tsvetoslav Hristov on Unsplash" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-01T00:00:00+01:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://pdemartino.github.io/assets/img/misc/stopwatch-photo-by-tsvetoslav-hristov-on-unsplash.webp" /><meta name="twitter:image:alt" content="Stopwatch photo by Tsvetoslav Hristov on Unsplash" /><meta property="twitter:title" content="SpringBoot StartUp Stats - A tool to identify beans which are slowing down your application startup" /><meta name="twitter:site" content="@pdemartino.com" /><meta name="google-site-verification" content="uu6HUf--KgUUTwPypKE0v_SkDZn0NgMo_KEdmVTyaIE" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-01T00:00:00+01:00","datePublished":"2022-12-01T00:00:00+01:00","description":"A Spring application is basically made up of Spring beans, “wrappers” of actual Java classes that are created by Spring framework at start-up (or on request if lazy-initialized) and injected as dependency where needed. That said, the start-up procedure of a Spring Boot application can be seen as a Tree, in which the roots are some internal Spring procedures and intermediate and leaf nodes are beans initializations. If bean “A” needs bean “B” as dependency, B will be child of A and the time needed to initialize bean A will be the time needed by A itself plus the summed time of its children.","headline":"SpringBoot StartUp Stats - A tool to identify beans which are slowing down your application startup","image":{"alt":"Stopwatch photo by Tsvetoslav Hristov on Unsplash","url":"https://pdemartino.github.io/assets/img/misc/stopwatch-photo-by-tsvetoslav-hristov-on-unsplash.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://pdemartino.github.io/articles/2022/12/springboot-startup-stats-identify-slow-beans/"},"url":"https://pdemartino.github.io/articles/2022/12/springboot-startup-stats-identify-slow-beans/"}</script><title>SpringBoot StartUp Stats - A tool to identify beans which are slowing down your application startup | Pasquale De Martino</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Pasquale De Martino"><meta name="application-name" content="Pasquale De Martino"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/img/pasquale-de-martino.webp" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">Pasquale De Martino</a></div><div class="site-subtitle fst-italic"></div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://www.linkedin.com/in/pasquale-de-martino/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/pdemartino" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['paco.dmp','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>SpringBoot StartUp Stats - A tool to identify beans which are slowing down your application startup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>SpringBoot StartUp Stats - A tool to identify beans which are slowing down your application startup</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1669849200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Dec 1, 2022 </em> </span><div class="mt-3 mb-3"> <a href="/assets/img/misc/stopwatch-photo-by-tsvetoslav-hristov-on-unsplash.webp" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/img/misc/stopwatch-photo-by-tsvetoslav-hristov-on-unsplash.webp" alt="Stopwatch photo by Tsvetoslav Hristov on Unsplash" width="1200" height="630" class="lazyload" data-proofer-ignore></a><figcaption class="text-center pt-2 pb-2">Stopwatch photo by Tsvetoslav Hristov on Unsplash</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/pdemartino">Pasquale De Martino</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1019 words" > <em>5 min</em> read</span></div></div></div><div class="post-content"><p>A <a href="https://spring.io/">Spring</a> application is basically made up of Spring beans, “wrappers” of actual Java classes that are created by Spring framework at start-up (or on request if lazy-initialized) and injected as dependency where needed. That said, the start-up procedure of a Spring Boot application can be seen as a Tree, in which the roots are some internal Spring procedures and intermediate and leaf nodes are beans initializations. If bean “A” needs bean “B” as dependency, B will be child of A and the time needed to initialize bean A will be the time needed by A itself plus the summed time of its children.</p><p>Getting an insight on the start-up procedure of a Spring Boot application is actually very simple, you just need to activate the <a href="https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.4-Release-Notes#startup-endpoint">Spring Boot StartUp actuator</a>.</p><p>Once activated, the startup events will be published via the <strong>“/actuator/startup”</strong> HTTP endpoint.</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"springBootVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.7.2"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"timeline"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"startTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:47.480064631Z"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"events"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"endTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:47.543243140Z"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PT0.045062101S"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"startTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:47.498181039Z"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"startupStep"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spring.boot.application.starting"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                        </span><span class="p">{</span><span class="w">
                            </span><span class="nl">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mainApplicationClass"</span><span class="p">,</span><span class="w">
                            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"com.pdemartino.ApplicationKt"</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="nl">"parentId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"endTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:48.690322544Z"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PT0.91235095S"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"startTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:47.777971594Z"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"startupStep"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spring.boot.application.environment-prepared"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                    </span><span class="nl">"parentId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"endTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:48.925252495Z"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PT0.000187068S"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"startTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:48.925065427Z"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"startupStep"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spring.boot.application.context-prepared"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                    </span><span class="nl">"parentId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"endTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:49.066986886Z"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PT0.003744429S"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"startTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:49.063242457Z"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"startupStep"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spring.boot.application.context-loaded"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                    </span><span class="nl">"parentId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"endTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:49.162692120Z"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PT0.011435772S"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"startTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-01T10:25:49.151256348Z"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"startupStep"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spring.beans.instantiate"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                        </span><span class="p">{</span><span class="w">
                            </span><span class="nl">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"beanName"</span><span class="p">,</span><span class="w">
                            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"org.springframework.boot.autoconfigure.internalCachingMetadataReaderFactory"</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="nl">"parentId"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="err">...</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>Every event represents a step executed during the start-up procedure, the following pieces of information are provided:</p><ul><li><strong>startTime</strong> and <strong>endTime</strong>: timestamp when the start-up step beging and when it finishes<li><strong>duration</strong>: a string containing the step duration, <em>S</em> suffix indicates seconds while M minutes<li><strong>startupStep.name</strong>: a step identifier (not unique), <em>startipStep.name = “spring.beans.instantiate”</em> indicated the creation of a Spring bean (the name of which can be found in the “tags” array)<li><strong>startupStep.id</strong>: unique identifier of the start-up step, it’s not supposed to be preserved across different hosts and deployments, hence name can be used as pivot<li><strong>startupStep.parentId</strong>: start-up events can be seen as a tree, this field define dependencies between steps, <em>parentId = null</em> indicates roots of the tree</ul><p>This diagram shows a simplified example of a Spring Boot application start-up procedure:</p><p><a href="/assets/img/posts/2022/12/SpringBoot-StartUp-Tree.webp" class="popup img-link "><img data-src="/assets/img/posts/2022/12/SpringBoot-StartUp-Tree.webp" alt="Spring Boot StartUp Tree" class="lazyload" data-proofer-ignore></a></p><p>Note, the duration reported by the actuator might be misleading. If you consider the example in the diagram above, you might think Bean A is time-consuming because duration reported by the actuator is 3.1 seconds, in fact that beans only takes 0.1 seconds to instantiate itself, while it waits 3 seconds for its dependencies.</p><p>Even though that JSON contains all the information, the reverse relationship (child → parent) and the fact that the net duration of intermediate steps is not explicit, some post-processing is required for extracting statistics useful to understand where bottlenecks are and on which bean you should focus on.</p><p>In order to extract useful (for our case) statistics out of the Startup Actuator, we used the <strong>springboot-startup-stats</strong> script (<a href="https://github.com/pdemartino/springboot-startup-stats">source code available on GitHub</a>).</p><p>If you’re running on Mac, you can install it by running the following commands:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>brew tap pdemartino/tap
brew <span class="nb">install </span>springboot-startup-stats
</pre></table></code></div></div><p>If we run the script against the startup endpoint, it will provide a tree representation of its content:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nv">$ ENDPOINT</span><span class="o">=</span>https://localhost:8080/actuator/startup
<span class="nv">$ </span>springboot-startup-stats <span class="nt">--mode</span> tree  <span class="nv">$ENDPOINT</span>
Source: https://localhost:8080/actuator/startup
Mode: tree
Offending Threshold: 1.7976931348623157E308
Tree Root:
 
<span class="o">[</span>0]spring.boot.application.starting - t:0.038712606
<span class="o">[</span>1]spring.boot.application.environment-prepared - t:0.765441
<span class="o">[</span>2]spring.boot.application.context-prepared - t:1.46107E-4
<span class="o">[</span>3]spring.boot.application.context-loaded - t:0.00252148
<span class="o">[</span>4]spring.context.refresh - t:0.3018837 - ∑t:38.849705s
├──[5]spring.context.beans.post-process - t:0.020615578 - ∑t:3.4185178s
│   ├──[6]...ng.beans.instantiate:org.springframework.context.annotation.internalConfigurationAnnotationProcessor - t:0.06522767 - ∑t:0.07434817s
│   │   └──[7]spring.beans.instantiate:org.springframework.boot.autoconfigure.internalCachingMetadataReaderFactory - t:0.009120496
│   ├──[8]spring.context.beandef-registry.post-process - t:0.04540038 - ∑t:2.6865594s
│   │   └──[9]spring.context.config-classes.parse - t:2.641159
│   ├──[10]spring.context.bean-factory.post-process - t:2.51665E-4
│   ├──[11]spring.context.bean-factory.post-process - t:6.455E-6
│   ├──[12]spring.context.bean-factory.post-process - t:9.2838705E-4 - ∑t:0.20036256s
│   │   └──[13]spring.context.config-classes.enhance - t:0.19943418
│   ├──[14]spring.context.bean-factory.post-process - t:4.4913E-5
│   ├──[15]spring.beans.instantiate:customBean - t:0.003065169
...
</pre></table></code></div></div><p>Among other pieces of information, the output contains:</p><ul><li>the parent→children relationship (reversed if compared with Actuator output)<li>the tree duration “∑t”, which is the same reported by the startup endpoint<li>the net duration “t”, which indicates exactly how long that bean takes, dependencies excluded</ul><p>The net duration <em>“t”</em> is the value we want to focus on in order to identify slow beans. What we did on the service under test was to extract the list of the steps which used to take more than 1 second to start:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nv">$ ENDPOINT</span><span class="o">=</span>https://localhost:8080/actuator/startup
<span class="nv">$ </span>springboot-startup-stats <span class="nt">--mode</span> stats <span class="nt">--offendingThreshold</span> 1.0 <span class="nv">$ENDPOINT</span>
Source: https://localhost:8080/actuator/startup
Mode: stats
Offending Threshold: 1.0
Tree Root:
Number of nodes: 816
Number of roots: 7
Number of leaves: 540
Global duration: 39.693936485637096
Offending nodes: 5
<span class="o">[</span>291]spring.beans.instantiate:beanA - t:16.057272 - ∑t:16.143324s
<span class="o">[</span>485]spring.beans.instantiate:beanB - t:3.2487843 - ∑t:3.419284s
<span class="o">[</span>287]spring.beans.instantiate:beanC - t:2.793414 - ∑t:2.8905766s
<span class="o">[</span>9]spring.context.config-classes.parse - t:2.641159
<span class="o">[</span>72]spring.beans.instantiate:beanD - t:1.8581195 - ∑t:2.7454188s
</pre></table></code></div></div><p>Given that output, we might want to get an insight, for example, on <em>beanA</em> bean and figure out why it takes 16.05 seconds to start, while its dependencies only take 0.09 seconds (<em>∑t - t</em>):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nv">$ ENDPOINT</span><span class="o">=</span>https://localhost:8080/actuator/startup
<span class="nv">$ </span>springboot-startup-stats <span class="se">\</span>
<span class="o">&gt;</span> <span class="nt">--mode</span> tree <span class="nt">--treeRoot</span> spring.beans.instantiate:beanA <span class="se">\</span>
<span class="o">&gt;</span> <span class="nv">$ENDPOINT</span>
Source: https://localhost:8080/actuator/startup
Mode: tree
Offending Threshold: 1.7976931348623157E308
Tree Root: spring.beans.instantiate:beanA
 
<span class="o">[</span>291]spring.beans.instantiate:beanA - t:16.057272 - ∑t:16.143324s
├──[292]...s.instantiate:com.pdemartino.childA - t:0.010470834
└──[293]spring.beans.instantiate:com.pdemartino.childB - t:0.075581245
</pre></table></code></div></div><p>Next step would surely be profile your application to figure out what <em>beanA</em> is doing during its initialization.</p><hr /><p><strong>Credits:</strong></p><ul><li>Stopwatch photo by <a href="https://unsplash.com/@tsvetoslav?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Tsvetoslav Hristov</a> on <a href="https://unsplash.com/photos/QW-f6s9nFIs?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Unsplash</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/spring/" class="post-tag no-text-decoration" >Spring</a> <a href="/tags/spring-boot/" class="post-tag no-text-decoration" >Spring Boot</a> <a href="/tags/performance/" class="post-tag no-text-decoration" >Performance</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SpringBoot%20StartUp%20Stats%20-%20A%20tool%20to%20identify%20beans%20which%20are%20slowing%20down%20your%20application%20startup%20-%20Pasquale%20De%20Martino&url=https%3A%2F%2Fpdemartino.github.io%2Farticles%2F2022%2F12%2Fspringboot-startup-stats-identify-slow-beans%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SpringBoot%20StartUp%20Stats%20-%20A%20tool%20to%20identify%20beans%20which%20are%20slowing%20down%20your%20application%20startup%20-%20Pasquale%20De%20Martino&u=https%3A%2F%2Fpdemartino.github.io%2Farticles%2F2022%2F12%2Fspringboot-startup-stats-identify-slow-beans%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fpdemartino.github.io%2Farticles%2F2022%2F12%2Fspringboot-startup-stats-identify-slow-beans%2F&text=SpringBoot%20StartUp%20Stats%20-%20A%20tool%20to%20identify%20beans%20which%20are%20slowing%20down%20your%20application%20startup%20-%20Pasquale%20De%20Martino" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ai/">AI</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">Docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/generative-ai/">Generative AI</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-bard/">Google Bard</a> <a class="post-tag btn btn-outline-primary" href="/tags/google/">Google</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">Jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/performance/">Performance</a> <a class="post-tag btn btn-outline-primary" href="/tags/spring-boot/">Spring Boot</a> <a class="post-tag btn btn-outline-primary" href="/tags/spring/">Spring</a> <a class="post-tag btn btn-outline-primary" href="/tags/zsh/">ZSH</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/articles/2023/08/google-bard-can-learn-from-you/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1692741600" data-df="ll" > Aug 23, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>I taught Google Bard how to use ZSH history expansion</h4><div class="text-muted small"><p> Despite my usual concerns and paranoia about privacy when it comes to using Google Products, I’ve been using Google Bard as a full replacement for standard search engines for a while now, and I hav...</p></div></div></a></div><div class="col"> <a href="/articles/2023/07/a-docker-based-dev-environment-for-jekyll/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1689804000" data-df="ll" > Jul 20, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>A Docker-based development environment for Jekyll</h4><div class="text-muted small"><p> Abstract Being a sofware engineer working with different projects made with different technologies, I often found myself in need of switching between multiple versions of the same build tool or app...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"><div class="btn btn-outline-primary disabled" prompt="Older" ><p>-</p></div><a href="/articles/2023/07/a-docker-based-dev-environment-for-jekyll/" class="btn btn-outline-primary" prompt="Newer" ><p>A Docker-based development environment for Jekyll</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://pdemartino.github.io/articles/2022/12/springboot-startup-stats-identify-slow-beans/'; this.page.identifier = '/articles/2022/12/springboot-startup-stats-identify-slow-beans/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver( function (entries) { if (entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://pdemartino-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] } ); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* Disqus hasn't been loaded */ if (typeof DISQUS === 'undefined') { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } } if (document.querySelector('.mode-toggle')) { window.addEventListener('message', reloadDisqus); } </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ai/">AI</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">Docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/generative-ai/">Generative AI</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-bard/">Google Bard</a> <a class="post-tag btn btn-outline-primary" href="/tags/google/">Google</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">Jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/performance/">Performance</a> <a class="post-tag btn btn-outline-primary" href="/tags/spring-boot/">Spring Boot</a> <a class="post-tag btn btn-outline-primary" href="/tags/spring/">Spring</a> <a class="post-tag btn btn-outline-primary" href="/tags/zsh/">ZSH</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a></p><p>© 2023 <a href="https://github.com/pdemartino">Pasquale De Martino</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/mermaid@9.4.3/dist/mermaid.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { /* start/end delimiter pairs for in-line math */ inlineMath: [ ['$', '$'], ['\\(', '\\)'] ], /* start/end delimiter pairs for display math */ displayMath: [ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-51022351-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-51022351-1'); }); </script> <script type="text/javascript"> (function () { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === 'undefined') { return; } let expectedTheme = mode === ModeToggle.DARK_MODE ? 'dark' : 'default'; let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $('.mermaid').each(function () { let svgCode = $(this).prev().children().html(); $(this).removeAttr('data-processed'); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, '.mermaid'); } } let initTheme = 'default'; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = 'dark'; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Create mermaid tag */ document.querySelectorAll('pre>code.language-mermaid').forEach((elem) => { const svgCode = elem.textContent; const backup = elem.parentElement; backup.classList.add('unloaded'); /* create mermaid node */ let mermaid = document.createElement('pre'); mermaid.classList.add('mermaid'); const text = document.createTextNode(svgCode); mermaid.appendChild(text); backup.after(mermaid); }); mermaid.initialize(mermaidConf); window.addEventListener('message', updateMermaid); })(); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
